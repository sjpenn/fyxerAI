<!-- Draft Reply Partial -->
<div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700 overflow-hidden">
    <div class="px-4 py-3 bg-blue-100 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-700">
        <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold text-blue-800 dark:text-blue-200">
                AI Draft Reply
            </h3>
            <div class="flex items-center space-x-2">
                <span class="text-xs text-blue-600 dark:text-blue-400">Tone: {{ tone|title }}</span>
                <svg class="w-4 h-4 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
                </svg>
            </div>
        </div>
    </div>
    
    <div class="p-4">
        <!-- Draft Content -->
        <div class="mb-4">
            <textarea 
                class="w-full h-32 p-3 text-sm border border-blue-200 dark:border-blue-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-vertical focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="AI-generated draft will appear here..."
                x-data
                x-ref="draftText"
            >{{ draft }}</textarea>
        </div>
        
        <!-- Action Buttons -->
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <!-- Tone Options -->
                <select class="text-xs border border-blue-200 dark:border-blue-600 rounded px-2 py-1 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
                    <option value="professional" {% if tone == 'professional' %}selected{% endif %}>Professional</option>
                    <option value="friendly" {% if tone == 'friendly' %}selected{% endif %}>Friendly</option>
                    <option value="formal" {% if tone == 'formal' %}selected{% endif %}>Formal</option>
                    <option value="brief" {% if tone == 'brief' %}selected{% endif %}>Brief</option>
                </select>
                
                <button 
                    class="text-xs px-2 py-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200"
                    hx-post="{% url 'emails:generate_draft' email_id %}"
                    hx-vals='js:{tone: this.previousElementSibling.value}'
                    hx-target="closest .bg-blue-50"
                    title="Regenerate with selected tone">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                </button>
            </div>
            
            <div class="flex items-center space-x-2">
                <!-- Copy to Clipboard -->
                <button 
                    class="text-xs px-3 py-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 border border-blue-300 dark:border-blue-600 rounded"
                    @click="navigator.clipboard.writeText($refs.draftText.value); $refs.copySuccess.style.display = 'inline'; setTimeout(() => $refs.copySuccess.style.display = 'none', 2000)">
                    Copy
                </button>
                
                <!-- Success Message -->
                <span x-ref="copySuccess" class="text-xs text-green-600 dark:text-green-400" style="display: none;">Copied!</span>
                
                <!-- Use Draft -->
                <button class="text-xs px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                    Use Draft
                </button>
            </div>
        </div>
        
        <!-- Disclaimer -->
        <div class="mt-3 pt-3 border-t border-blue-200 dark:border-blue-700">
            <p class="text-xs text-blue-600 dark:text-blue-400">
                <svg class="w-3 h-3 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                AI-generated content. Please review and edit before sending.
            </p>
        </div>
    </div>
</div>